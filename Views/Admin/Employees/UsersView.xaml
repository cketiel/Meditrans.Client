<UserControl x:Class="Meditrans.Client.Views.Admin.Employees.UsersView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:helpers="clr-namespace:Meditrans.Client.Helpers"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">

    <UserControl.Resources>
        <helpers:BindingProxy x:Key="vmProxy" Data="{Binding}" />
    </UserControl.Resources>

    <Border BorderThickness="1" BorderBrush="#2196f3" Background="White">
        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                <Button Command="{Binding AddUserCommand}"
                        Style="{StaticResource MaterialDesignFloatingActionMiniButton}"
                        ToolTip="{Binding AddUserToolTip}"
                        Margin="0,0,20,0">
                    <materialDesign:PackIcon Kind="AccountPlus" Height="24" Width="24" />
                </Button>
            </StackPanel>

            <DataGrid Grid.Row="1"
                      ItemsSource="{Binding Users}"
                      SelectedItem="{Binding SelectedUser, Mode=TwoWay}"
                      SelectionMode="Single"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      Style="{StaticResource CustomDataGridStyle}">

                <DataGrid.Columns>
                    <DataGridTemplateColumn Width="Auto">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Button Command="{Binding DataContext.EditUserCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                            Style="{StaticResource MaterialDesignToolButton}"
                                            ToolTip="{Binding Data.EditUserToolTip, Source={StaticResource vmProxy}}">
                                        <materialDesign:PackIcon Kind="Pencil" Foreground="Orange"/>
                                    </Button>
                                    <Button Command="{Binding DataContext.ChangePasswordCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                        Style="{StaticResource MaterialDesignToolButton}"
                                        ToolTip="{Binding Data.ChangePasswordToolTip, Source={StaticResource vmProxy}}">
                                        <materialDesign:PackIcon Kind="KeyChange" Foreground="Blue"/>
                                    </Button>
                                    <Button Command="{Binding DataContext.DeleteUserCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                            Style="{StaticResource MaterialDesignToolButton}"
                                            ToolTip="{Binding Data.DeleteUserToolTip, Source={StaticResource vmProxy}}">
                                        <materialDesign:PackIcon Kind="DeleteForever" Foreground="Red"/>
                                    </Button>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTextColumn
                        Header="{Binding Data.ColumnHeaderFullName, Source={StaticResource vmProxy}}" 
                        Binding="{Binding FullName}" Width="2*"/>
                    <DataGridTextColumn 
                        Header="{Binding Data.ColumnHeaderUserName, Source={StaticResource vmProxy}}" 
                        Binding="{Binding Username}" Width="*"/>
                    <DataGridTextColumn 
                        Header="{Binding Data.ColumnHeaderEmail, Source={StaticResource vmProxy}}"  
                        Binding="{Binding Email}" Width="2*"/>
                    
                    <DataGridTextColumn 
                        Header="{Binding Data.ColumnHeaderRole, Source={StaticResource vmProxy}}"
                        Binding="{Binding Role.RoleName}" Width="*"/>
                    <DataGridCheckBoxColumn 
                        Header="{Binding Data.ColumnHeaderActive, Source={StaticResource vmProxy}}"
                        Binding="{Binding IsActive}" Width="Auto"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Border>
</UserControl>